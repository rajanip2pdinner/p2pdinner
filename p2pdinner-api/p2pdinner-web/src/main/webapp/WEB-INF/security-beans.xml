<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
             xmlns:context="http://www.springframework.org/schema/context"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd

    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">
       <context:component-scan base-package="com.p2p" />
       <beans:bean id="exceptionProvider" class="com.p2p.exceptions.SecurityExceptionMapper" />

       <beans:bean id="stormpathClient" class="com.stormpath.spring.security.client.ClientFactory" >
              <!-- If you've configured a Spring CacheManager (recommended to reduce network calls) -->
              <!-- <property name="cacheManager" ref="cacheManager" /> -->
              <beans:property name="apiKeyProperties">
                    <beans:props>
                           <beans:prop key="apiKey.id">2BZ5P91LP0DPVZZXNI9UP42HG</beans:prop>
                           <beans:prop key="apiKey.secret">9Sfjb8Rl8UY/Dyb+W4WrQa8QATBcxInSveRRZ1ZLVys</beans:prop>
                    </beans:props>
              </beans:property>
       </beans:bean>

       <beans:bean id="authenticationProvider" class="com.stormpath.spring.security.provider.StormpathAuthenticationProvider">
              <beans:property name="client" ref="stormpathClient" />
              <beans:property name="applicationRestUrl" value="https://api.stormpath.com/v1/applications/2e2VTO48vmSJO8MJtBmoXT"/>
       </beans:bean>

       <http create-session="stateless">
              <intercept-url pattern="/**" access="hasAnyRole('https://api.stormpath.com/v1/groups/6cFPy0lW0hSOVHrTzhjhUP', 'ROLE_https://api.stormpath.com/v1/groups/6cFPy0lW0hSOVHrTzhjhUP')" />
              <!-- <logout logout-url="/logout" logout-success-url="/logoutSuccess.jsp"/> -->
              <http-basic />
       </http>

       <authentication-manager alias="security">
              <authentication-provider ref='authenticationProvider'/>
       </authentication-manager>

       <!--
       <authentication-manager alias="security">
              <authentication-provider>
                     <user-service>
                            <user name="p2pdinner" password="p2pdinner" authorities="ROLE_ADMIN" />
                     </user-service>
              </authentication-provider>
       </authentication-manager>
       -->

       <!-- HTTP basic authentication in Spring Security with http intercept url pattern [Option 2]
       <http create-session="stateless" use-expressions="true">
              <intercept-url pattern="/**" access="hasRole('ROLE_ADMIN')" />
              <http-basic />
       </http>
       -->
</beans:beans>